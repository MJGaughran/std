<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR" content="Mozilla/4.77 [en] (X11; U; SunOS 5.8 sun4u) [Netscape]">
  <title></title>
</head>

<body text="#000000" bgcolor="#ffffff" link="#0000ee" vlink="#551a8b" alink="#ff0000">

<center>
  <h1>Standard Support<BR>Release Notes</h1>
</center>

<h2>Release 1-5,&nbsp;&nbsp;Not Yet</h2>
<ul>
<li> sscan record v5.18
    <ul>

	<li>the sscan record can now read array-valued PVs in scalar mode
	(ACQT=="SCALAR" (0)) as well as in array mode (ACQT=="1D ARRAY" (1)). In
	scalar mode, array PVs are read after the last data point has been
	acquired.

	<li>New trigger for array read.  In the event array PVs need a poke to get
	them to read or otherwise prepare their data for use, the sscan record has
	an array-read trigger -- a set of fields similar to those of a detector
	trigger.  The trigger is fired and waited for after the last data point has
	been acquired, and before any after-scan motions are commanded.

	<li>Handshaking with saveData has been modified to make use of the sscan
	record's double buffering.  The old data-storage-client handshake method
	still works, but is no longer recommended.  In the new method, saveData
	writes "1" to AWAIT (new field) when DATA -> 1.  This allows the sscan
	record to go on to the next scan up to the point of posting the next scan's
	data arrays.  When saveData is done with the sscan record's arrays, it
	writes "0" to AWAIT, allowing the sscan record to post new data.  In one
	test with 10 1000-point arrays, and a 50 ms detector dwell time, the
	average total scan overhead per data point was 2.4 ms.  (It took saveData
	roughly 40 ms to write the data, so the date storage time overlapped
	completely with the detector dwell time, effectively removing it completely
	from the scan overhead.)
	
	<P>There is no provision in the AWAIT handshake for more than one data-
	storage client.  If other data-storage clients need to handshake, they
	must use the WAIT handshake.

    </ul>
<li> saveData v1.14.0
    <ul>
	
	<li>saveData no longer uses the handshake PVs specified in the saveData.req
	file it reads at startup.  Instead, it now writes to <sscanRecord>.AWAIT.

	<li>saveData now writes the disabling handshake when sscan record data are
	posted (<i>scanrec</i>.DATA==1), instead of when the scan begins, and it
	writes to the sscan record that posted, rather than to the PV named in
	saveData.req

	<li>saveData no longer allocates memory for sscanRecord detector signals
	that are not in use.  When a valid detector PV has been defined, saveData
	allocates memory for it, and does not free that memory if the PV becomes
	invalid.

	</ul>

<li> Scaler record v3.15: support for Joerger VS64 scaler added

    <ul>

	<li>The mamximum number of channels is increased to 64.

	<li>Added semaphore to avoid contention for scanLock between
	autocount-restart callback and periodic-update callback. 
	Periodic-update callback no longer scan locks.

    <li>Device support for all scalers but Joerger VS needs the record to tell
	it the clock rate, but VS device support chooses a clock rate.  To support
	both, dset->write_preset() is called twice -- once to specify dwell time
	with whatever value of FREQ is current, and again using the possibly new
	value chosen by device support.  If device support changed FREQ, the record
	posts the new value.

    <li>The 'T' field is now posted after all counter values

	</ul>

<li> devScaler_VS v1.0

    <ul>
	
	<li>New device support for Joerger VS series read-on-the-fly scalers.  Note
	this software does not support the "Dead-Time-less" version of the VS
	scaler.  The device type for this scaler is "Joerger VS".

    <ul>

<li>save_restore v3.5; dbrestore v

    <ul>

	<li>support for array-valued PVs.  Arrays are read and written using
	database access, and are written only during pass 1 (the second pass --
	after database initialization).  Array PVs are specified in the request
	file in the same way as scalar PVs.

	<li>The order in which PVs occur in the .sav file is now the same as in the
    .req file.

	<li>support for PVs whose field types are changed from DBF_NOACCESS to some
	accessible type during record initialization (e.g., several gensubRecord
	fields).

	<li>manual-restore operations now done by the save_restore task (which now
	does all of the channel-access work.

	</ul>

<li> transform record v5.8

    <ul>
	
	<li>New field, IVL<i>n</i>, specifies what the record should do if an
	invalid-link error (NSEV==INVALID_ALARM) is encountered.  Options are
	("Ignore error" (0); "Do Nothing" (1)).  "Ignore", the default, is what
	previous versions did. "Do Nothing" means don't even start evaluating
	expressions; just post alarms and exit.

	<li>The first valid calculation posts it result even if the value didn't
	changed from the initial value of zero.  (Otherwise, clients don't know if
	they should use the zero value, or wait for a monitor that may never come.)
	
	<li>Test for new value had a typo that made zero always look old (no recalc)
	
	<li>Values are now posted with DBE_VALUE | DBE_LOG.  Previously, values
    were posted with DBE_VALUE.

	<li>Postfix buffers are now allocated at boot time.  Previously,
	sCalcPostfix() allocated a new postfix buffer each time it was called.
	
	<li>CLC<i>n</i> fields are no longer checked by dbStaticLib (i.e., by
	database-configuration tools, and at boot time) because EPICS base
	doesn't know how to check them.
	
	</ul>

<li>kohzuCtl.st v3.2

    <ul>
	
	<li>Allow boot-time choice (the BOOLEAN variable kohzuCtlCalibYZ) of
	whether or not Y and Z motors shhould be recalibrated when in SET mode. 
	Previously, they were recalibrated unconditionally.

	</ul>

<li>test_sCalc.py - new python program to check sCalc expression evaluation.

<li>test_sCalc.c - new timing tests for sCalcPostfix, sCalcPerform.

<li>sCalcPostfix, sCalcPerform

    <ul>
	
	<li>Much faster than previous versions, with better defense against
	illegal expressions
	
	<li>now requires caller to allocate storage for postfix array, and pass it
	as char* instead of char**.

    <li>MAX and MIN now take two or more arguments
	
	<li>operators "<?" and ">?" added
	
	</ul>
	
</ul>

<h2>Release 1-4,&nbsp;&nbsp;January 29, 2004</h2>

<ul>
  <li>Added or updated documentation for IK320, autoSaveRestore, epid record,
      genSub record, gpibRecord, lookup-table (interp), sCalcout record, saveData
      file format, scaler record, sscan record, sseq record, table record,
      transform record, and vme record.</li>
  <li>Added autosave request files for BunchClkGenA, IK320, scaler, SGM, 4step,
      scan parameters, sscan record, swait record, table record, transform record,
      userAve, userCalcs, userStringCalcs, userTransforms</li>
  <li>interp - Added this support for lookup-table applications</li>
  <li>module_types.c - moved to xxx module </li>
  <li>std no longer makes choices of objects in base for xxx</li>
  <li>BitBus is no longer supported</li>
  <li>saveData - saveData_SetCptWait() function replaced by saveData_SetCptWait_ms() because PPC processors cannot use floating point arguments in st.cmd</li>

  <li>
    Heidenhain IK320 bug fixes.
    <ul>
      <li>
	Bug fix for bus error in devIK320.c and drvIK320.c if IK320 hardware
	is missing.
      </li>				        
      <li>
	PowerPC bug fix. For EPICS R3.13.5 and above, devDisconnectInterrupt()
	always returns an error for the PPC architecture. Replaced calls to
	devDisconnectInterrupt() with updates to device handler pointer
	(irqHandler) and a master device interrupt handler (IK320IrqMaster).
      </li>
      <li>
	Fix drvIK320report() trashing all the other reports.
      </li>				        
    </ul>
  </li>
  <li>
    sseq_settings.req file added to stdApp/Db for auto-saving sseq record fields.
  </li>				        
  <li>
    save/restore V3.3
    <ul>
      <li>
	Updated from V2.7 to V3.3.
      </li>				            
      <li>
	new save/restore files; save_restoreStatus.db, save_restoreStatus.adl,
	autoSaveRestore.README
      </li>				        
    </ul>
  </li>				        
  <li>
    transformRecord test for new value bug fix.
  </li>				        
</ul>


<h2>Release 1-3,&nbsp;&nbsp;July 9, 2003</h2>
<ul>
  <li>
    XIA_shutter.db - Added records that open and close the shutter by writing string 
    commands, rather than requiring the client to write the strings.&nbsp; This 
    allows the shutter to be controlled directly by the sscan record, which cannot 
    write strings.
  </li>
  <li>
    hrSeq.db - v 3.2 modified to support non-nested dispersive double crystal 
    geometry.
  </li>
  <li>
    scan.db - Added MAXPTSH macro, saveData_comment1, and saveData_comment2. &nbsp;Added 
    scanActive calc.&nbsp; Deleted default detectors and triggers.
  </li>
  <li>
    userAve10.db - add restart, one-shot support, report current sample.
  </li>
  <li>
    XIA_shutter.adl - XIA_shutter_more.adl - XIA_shutter_small.adl - Changed buttons 
    that open and close the shutter so that they process records that write string 
    commands, rather than writing the string commands directly.&nbsp; This allows 
    the shutter to be controlled directly by the sscan record, which cannot write 
    strings.
  </li>
  <li>
    hrSeqCtl_All.adl - Added selector for geometry (nested/symmetric).
  </li>
  <li>
    scan.adl - scan_detectors10.adl - scan_detectorsOld.adl - scan_more.adl -scan_positioners.adl 
    - dynLink status (e.g., red X's) no longer shows when no PV has been entered (requires 
    MEDM v2.3.6 or later).
  </li>
  <li>
    table_setup_GEOCARS.adl - table_setup_NEWPORT.adl - table_setup_PNC.adl - 
    table_setup_SRI.adl - RZ field wasn't being displayed for some reason.
  </li>
  <li>
    userAve.adl - Added one-shot/continuous, restart, current sample.
  </li>
  <li>
    dbrestore.c -save_restore.c - fGetDateStr.c added -fGetDateStr.h added - V2.7; 
    Added include-file and macro-substitution capabilities.&nbsp; Added Frank 
    Lenkszus' modifications (file path, set_passN_restoreFile, reload save sets, etc.)
  </li>
  <li>
    hrCtl.st - Added symmetric geometry, fixed phi2 init, phi offsets recalculated 
    on transition into Set mode, Set mode no longer wipes world offsets.
  </li>
  <li>
    initHooks.c - Modified to support V2.7 dbrestore.c; add support to restore from 
    a list of save files.
  </li>
  <li>
    sCalcPerform.c - sCalcPostfix.c - sCalcPostfixPvt.h - Added BYTE operator.
  </li>
  <li>
    saveData.c - v1.13 Trigger PV now retains field name; realTime1D was treated as 
    int, instead of short, so it seemed to be on at boot; null terminate DBR_STRING, 
    so string variables behave right.
  </li>
  <li>
    subAve.c - limit number of samples to average, reset restart field (.A), report 
    current sample number (.E).
  </li>
  <li>
    transformRecord.c - transformRecord.html - v 5.4; New way to determine if a 
    value should be recalculated: if not same as old value and if not marked in 
    bitmap.&nbsp; Bitmap is marked if value is written to unless PACT was true at 
    the time.&nbsp; New debug calc prints info with lower value of 
    transformRecordDebug if TPRO is true.
  </li>
</ul>


<h2>Release 1-2,&nbsp;&nbsp;Jan 2002</h2>

<ul>
  <li>
    Added softMotor.db to stdApp/Db, to Makefile.Host and added 
    the following softMotor.db related medm displays to stdApp/op/adl; 
    softMotorConfig.adl, softMotorHelp.adl and softMotors10.adl.
  </li>
  <li>
    Changed DTYP in BunchClkGenA.db from "Soft Record" to "Soft Channel".
  </li>
</ul>

</body>
</html>
